# reth-db-tune migrate

Migrate a RocksDB database with custom tuning options.

```bash
$ reth-db-tune migrate --help
```
```txt
Usage: reth-db-tune migrate [OPTIONS] --src <PATH> --dst <PATH> --config <PATH>

Options:
      --src <PATH>       Source database path
      --dst <PATH>       Destination database path
      --config <PATH>    Path to TOML config file
      --jobs <N>         Override max background jobs from config
      --compact          Run compaction after copy [default: true]
      --verify           Verify all keys/values match after migration [default: false]
      --overwrite        Remove existing destination directory [default: false]
  -h, --help             Print help
```

## Options

| Flag | Description | Default |
|------|-------------|---------|
| `--src` | Source database path | Required |
| `--dst` | Destination database path | Required |
| `--config` | Path to TOML config file | Required |
| `--jobs` | Override max background jobs | From config |
| `--compact` | Run compaction after copy | `true` |
| `--verify` | Verify all keys/values match | `false` |
| `--overwrite` | Remove existing destination | `false` |

## Examples

### Basic migration with compaction

```bash
reth-db-tune migrate \
  --src ~/.local/share/reth/mainnet/db \
  --dst /mnt/fast-nvme/reth-tuned/db \
  --config optimized.toml
```

### Migration with verification

```bash
reth-db-tune migrate \
  --src ~/.local/share/reth/mainnet/db \
  --dst /mnt/fast-nvme/reth-tuned/db \
  --config optimized.toml \
  --verify
```

### Quick test migration

```bash
reth-db-tune migrate \
  --src ~/.local/share/reth/mainnet/db \
  --dst /tmp/reth-test-db \
  --config test.toml \
  --overwrite
```

## Migration Report

After migration, a `migration_report.json` is written to the destination directory:

```json
{
  "source_path": "/path/to/source",
  "destination_path": "/path/to/destination",
  "column_families": [
    {
      "name": "Headers",
      "keys_copied": 21000000,
      "bytes_copied": 4200000000,
      "duration_secs": 45.2
    }
  ],
  "total_duration_secs": 1234.5,
  "compact_performed": true,
  "verify_performed": true,
  "verify_passed": true
}
```
