number: 20911
title: Improve transaction handling in payload processing
state: open
author: ahsenkamal
head: include-tx-index
base: main
labels: []
created_at: 2026-01-10T12:49:13Z
updated_at: 2026-01-10T15:16:40Z
additions: 37
deletions: 25
is_draft: true
files:
- path: crates/engine/tree/src/tree/payload_processor/mod.rs
  additions: 6
  deletions: 3
- path: crates/engine/tree/src/tree/payload_processor/prewarm.rs
  additions: 8
  deletions: 22
- path: crates/optimism/primitives/src/transaction/signed.rs
  additions: 4
  deletions: 0
- path: crates/primitives-traits/src/transaction/signed.rs
  additions: 19
  deletions: 0
body: "Solves #20431 \r\n\r\n- Fix incorrect transaction index in prewarm task\r\n    - Included the original index of transactions from the iterator while passing them over channel by sending `(idx, tx)`\r\n- Add is_system_tx method on transaction type\r\n    - standard check of type > 4\r\n    - for OP it returns if the tx is a deposit\r\n- WIP: Redundant transaction decoding https://github.com/paradigmxyz/reth/blob/main/crates/ethereum/payload/src/validator.rs#L79"
