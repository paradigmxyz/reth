on:
  pull_request:
  merge_group:
  push:
    branches: [main]

jobs:
  check-dashboard:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v5
      - name: Check for ${DS_PROMETHEUS} in overview.json
        run: |
          if grep -F '${DS_PROMETHEUS}' etc/grafana/dashboards/overview.json; then
            echo "Error: overview.json contains '\${DS_PROMETHEUS}' placeholder"
            echo "Please replace it with '\${datasource}'"
            exit 1
          fi
          echo "âœ“ overview.json does not contain '\${DS_PROMETHEUS}' placeholder"
